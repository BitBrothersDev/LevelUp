- skill_level = skill_level_item.skill_level
%div{:id => "#{dom_id skill_level_item}", :class => "skill-card"}
  .skill-card-header
    %h3= skill_level_item.name
    - if !skill_level_item.tip.blank?
      .skill-tip= skill_level_item.tip

  -# Stats Section with Gamification
  .card-stats
    .stat-badge
      .stat-icon ðŸ“–
      .d-flex.flex-column.align-items-start
        .stat-value= skill_level_item.learning_materials_count
        .stat-label Materials

    .stat-badge
      .stat-icon
        = render 'skills/estimation_skill_level_item', skill_level_item: skill_level_item
      .d-flex.flex-column.align-items-start
        .stat-label Progress

  -# Action Buttons
  .card-actions
    = link_to skill_level_item_path(skill_level_item), class: 'modern-btn btn-primary-modern' do
      %i.bi.bi-eye
      View Details

    %button.modern-btn.btn-secondary-modern{"data-bs-target" => "#collapse-learning-material-#{skill_level_item.id}", "data-bs-toggle" => "collapse", :type => "button"}
      %i.bi.bi-book
      Materials (#{skill_level_item.learning_materials_count})

  -# Collapsible Learning Materials Section
  .materials-section
    .collapse{:id => "collapse-learning-material-#{skill_level_item.id}"}
      - skill_learning_materials = skill_level_item.learning_materials
      - if skill_learning_materials.any?
        .materials-grid
          - skill_level_item.learning_materials.each do |material|
            .material-card
              = render 'skills/learning_materials/material', material: material, skill_level: skill_level

          -# Add Material Button
          .material-card.add-material-card
            %button.modern-btn.btn-secondary-modern{"data-bs-target" => "#modal-add-material-#{skill_level.id}-#{skill_level_item.id}-", "data-bs-toggle" => "modal", :type => "button"}
              %i.bi.bi-plus-circle
              Add Material
      - else
        .text-center.p-4
          %p.text-muted No materials yet
          %button.modern-btn.btn-primary-modern{"data-bs-target" => "#modal-add-material-#{skill_level.id}-#{skill_level_item.id}-", "data-bs-toggle" => "modal", :type => "button"}
            %i.bi.bi-plus-circle
            Add First Material

  -# Own Explanation Section (if exists)
  - if skill_level_item.own_explanation.present?
    .mt-3
      %small.text-muted ðŸ’­ Your Notes:
      .p-3.bg-light.rounded-3.mt-2{:style => "font-size: 0.9rem;"}
        = skill_level_item.own_explanation

  -# Skill Reference
  .mt-3
    %small.text-muted
      Part of:
      = link_to skill_level.skill.name, skill_level.skill, class: 'text-decoration-none fw-semibold'

  -# Hidden Modals (keep existing functionality)
  = render 'skills/add_skill_level_item', skill_level: skill_level, skill_level_item: skill_level_item
  = render 'skills/add_learning_material', skill_level: skill_level, skill_level_item: skill_level_item
