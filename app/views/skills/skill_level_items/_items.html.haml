- skill_learning_materials = skill_level.learning_materials.where(skill_level_item: skill_level_item)

.modern-card.skill-level-item-card{ id: dom_id(skill_level_item) }
  .d-flex.flex-wrap.align-items-start.justify-content-between.gap-3
    .flex-grow-1
      %h4.card-title.mb-1= skill_level_item.name
      %p.card-meta.mb-0= skill_level_item.tip.present? ? skill_level_item.tip : 'No additional tips yet.'
    .floating-toolbar
      = render 'skills/estimation_skill_level_item', skill_level_item: skill_level_item
      = link_to 'View', skill_level_item_path(skill_level_item), class: 'btn btn-sm btn-outline-primary'
      %button.btn.btn-sm.btn-outline-secondary{"data-bs-target" => "#modal-add_skill_level_item-#{skill_level.id}-#{skill_level_item.id}", "data-bs-toggle" => "modal", :type => "button"}
        %i.bi.bi-pencil
        Edit

  %button.btn.btn-link.p-0.mt-3.text-decoration-none{ "data-bs-target" => "#collapse-learning-material-#{skill_level_item.id}", "data-bs-toggle" => "collapse", :aria => { expanded: skill_learning_materials.any?, controls: "collapse-learning-material-#{skill_level_item.id}" } }
    = skill_learning_materials.any? ? 'Hide learning materials' : 'Show learning materials'

  .collapse.mt-3{:class => (skill_learning_materials.any? ? 'show' : ''), :id => "collapse-learning-material-#{skill_level_item.id}"}
    - if skill_learning_materials.any?
      .modern-list.mb-3
        - skill_learning_materials.each do |material|
          = render 'skills/learning_materials/material', material: material, skill_level: skill_level
    - else
      .empty-state.mb-3
        %h5.mb-2 No materials yet
        %p.mb-0 Add supporting content to reinforce this item.

    %button.btn.btn-outline-primary.btn-sm{"data-bs-target" => "#modal-add-material-#{skill_level.id}-#{skill_level_item.id}-", "data-bs-toggle" => "modal", :type => "button"}
      %i.bi.bi-plus-lg.me-1
      Add material

= render 'skills/add_learning_material', skill_level: skill_level, skill_level_item: skill_level_item
= render 'skills/add_skill_level_item', skill_level: skill_level, skill_level_item: skill_level_item